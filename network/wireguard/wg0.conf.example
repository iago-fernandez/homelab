# /etc/wireguard/wg0.conf

# Primary WireGuard server interface configuration.
# Defines the internal VPN subnet, cryptographic identity, and dynamic
# NAT traversal rules for outbound client traffic.

[Interface]
Address = 10.8.0.1/24
ListenPort = 51820
PrivateKey = <SERVER_PRIVATE_KEY_REDACTED>

# Dynamic NAT Traversal
# Identifies the default WAN interface and applies IP masquerading to route VPN traffic
PostUp = WAN=$(ip -4 route list default | awk '{print $5; exit}'); iptables -t nat -A POSTROUTING -o "$WAN" -j MASQUERADE
PostDown = WAN=$(ip -4 route list default | awk '{print $5; exit}'); iptables -t nat -D POSTROUTING -o "$WAN" -j MASQUERADE

# Client Provisioning Example
[Peer]
PublicKey = <CLIENT_PUBLIC_KEY_REDACTED>
PresharedKey = <PRESHARED_KEY_REDACTED>
AllowedIPs = 10.8.0.2/32